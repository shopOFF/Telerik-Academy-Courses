namespace BitShiftMatrix{using System;using System.Linq;using System.Numerics;class Startup{static void Main(){var rowsCount=int.Parse(Console.ReadLine());var colsCount=int.Parse(Console.ReadLine());var n=Console.ReadLine();var collected=new bool[rowsCount,colsCount];var moves=Console.ReadLine().Split((char)32).Select(int.Parse).ToArray();var sum=0;var row=rowsCount-1;var col=0;var currentCellValue=1;var coeff=Math.Max(rowsCount,colsCount);foreach(var movein moves){var nextRow=move/coeff;var nextCol=move%coeff;var deltaCol=col>nextCol?-1:1;while(col!=nextCol){if(!collected[row,col]){sum+=currentCellValue;collected[row,col]=true;}if(deltaCol==1){currentCellValue*=2;}else{currentCellValue/=2;}col+=deltaCol;}var deltaRow=row>nextRow?-1:1;while(row!=nextRow){if(!collected[row,col]){sum+=currentCellValue;collected[row,col]=true;}if(deltaRow==1){currentCellValue/=2;}else{currentCellValue*=2;}row+=deltaRow;}}Console.WriteLine(sum);}}}
